[{"kind":1,"language":"markdown","value":"# Lecture 05 — Hierarchical Clustering in SAS\r\n\r\nIn this notebook we will:\r\n1. Define the SAS library\r\n2. Run hierarchical clustering with **Single Linkage**\r\n3. Draw the dendrogram\r\n4. Run hierarchical clustering with **Ward’s Method**\r\n5. Cut the dendrogram into clusters\r\n6. Check cluster sizes and profiles","outputs":[]},{"kind":1,"language":"markdown","value":"## 0. Define the library\r\n\r\nWe tell SAS where the datasets are stored.  \r\n- Students: use the local path (writable).  \r\n- Teacher: has a read-only shared path (commented out).","outputs":[]},{"kind":2,"language":"sas","value":"/* Path for students */\r\nlibname c \"C:\\Camillo_clabe\";\r\n\r\n/* Path for teacher (read-only, commented out) */\r\n/* libname c \"---\\MaterialeDocente\\Camillo_clabe\"; */","outputs":[]},{"kind":1,"language":"markdown","value":"## 1. Single linkage clustering\r\n\r\n- Input dataset: `c.unico_1`  \r\n- Method: **Single linkage** (minimum distance between points)  \r\n- Output: `c.tree_single`  \r\n- `var d10_:` → selects all variables with prefix `d10_`  \r\n- `id id` → uses the variable `id` as identifier. “Which variable should I use as the label (identifier) for each observation in the dendrogram or cluster output?”","outputs":[]},{"kind":2,"language":"sas","value":"proc cluster data=c.unico_1 method=single outtree=c.tree_single;\r\n    var d10_: ;\r\n    id id;\r\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"## 2. Draw dendrogram for Single linkage\r\n\r\nWe use `PROC TREE` to visualize the hierarchical structure.  \r\nLater we can also cut the tree into groups.","outputs":[]},{"kind":2,"language":"sas","value":"proc tree data=c.tree_single;\r\n    id id;\r\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"## 3. Ward’s method clustering\r\n\r\n- Method: **Ward** (minimizes within-cluster variance)  \r\n- Output: `c.tree_ward`  \r\n- This usually produces more compact, homogeneous clusters.","outputs":[]},{"kind":2,"language":"sas","value":"proc cluster data=c.unico_1 method=ward outtree=c.tree_ward;\r\n    var d10_: ;\r\n    id id;\r\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"## 4. Draw dendrogram for Ward’s method\r\n\r\nNow we display the Ward dendrogram.","outputs":[]},{"kind":2,"language":"sas","value":"proc tree data=c.tree_ward;\r\n    id id;\r\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"## 5. Cutting the dendrogram\r\n\r\nTwo options:\r\n1. Fix the **number of clusters** (e.g. 3)  \r\n2. Cut at a specific **height** (fusion distance = 7)","outputs":[]},{"kind":2,"language":"sas","value":"/* Cut into 3 clusters */\r\nproc tree data=c.tree_ward nclusters=3 out=c.clus3;\r\n    id id;\r\nrun;\r\n\r\n/* Cut at height=7 */\r\nproc tree data=c.tree_ward height=7 out=c.clus_h7;\r\n    id id;\r\nrun;","outputs":[]},{"kind":1,"language":"markdown","value":"## 6. Quick checks\r\n\r\n- `PROC FREQ` → cluster sizes  \r\n- `PROC MEANS` → cluster profiles (means, standard deviations per cluster)","outputs":[]},{"kind":2,"language":"sas","value":"/* Cluster sizes */\r\nproc freq data=c.clus3;\r\n    tables cluster / nocum;\r\nrun;\r\n\r\n/* Cluster profiles */\r\nproc means data=c.clus3 mean std maxdec=2;\r\n    class cluster;\r\n    var d10_: ;\r\nrun;","outputs":[]}]